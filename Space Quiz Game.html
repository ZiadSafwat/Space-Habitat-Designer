<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ Space Habitat Quiz Game</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #0c0c1e 0%, #2d1b69 50%, #1a0b33 100%);
            color: white;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        .stars {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 0;
        }
        .star {
            position: absolute; background: white; border-radius: 50%;
            animation: twinkle 3s infinite alternate;
        }
        @keyframes twinkle {
            0% { opacity: 0.3; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1.2); }
        }
        .container {
            max-width: 800px; margin: 0 auto; padding: 20px;
            position: relative; z-index: 1;
        }
        .quiz-header {
            text-align: center; margin-bottom: 30px;
            background: rgba(255,255,255,0.1); padding: 30px; border-radius: 20px;
            backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2);
        }
        .quiz-title { font-size: 2.5em; margin-bottom: 10px; }
        
        /* CSS-based Planet Graphics */
        .planets-header {
            display: flex; justify-content: center; margin: 22px 0 7px 0; gap: 20px;
        }
        .planet-saturn {
            width: 50px; height: 50px; border-radius: 50%;
            background: linear-gradient(45deg, #ffd700, #ffb347);
            position: relative; animation: float 3s ease-in-out infinite alternate;
        }
        .planet-saturn::after {
            content: '';
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 70px; height: 15px; border-radius: 50%;
            border: 3px solid rgba(255, 215, 0, 0.7);
            background: transparent;
        }
        .planet-neptune {
            width: 45px; height: 45px; border-radius: 50%;
            background: linear-gradient(45deg, #4169e1, #87ceeb);
            animation: float 3s ease-in-out infinite alternate-reverse;
        }
        
        /* CSS-based Astronaut Graphics */
        .astronaut-avatars {
            margin: 15px 0; display: flex; justify-content: center; gap: 16px; align-items: center;
        }
        .astronaut {
            width: 50px; height: 50px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 24px; transition: transform 0.3s ease;
            box-shadow: 0 4px 15px rgba(255,255,255,0.3);
        }
        .astronaut:hover { transform: scale(1.1); }
        .astronaut-1 { background: linear-gradient(45deg, #ff6b6b, #ffa726); }
        .astronaut-2 { background: linear-gradient(45deg, #4ecdc4, #45b7d1); }
        .astronaut-3 { background: linear-gradient(45deg, #a8e6cf, #88d8a3); }
        
        /* Smiling Planet */
        .smiling-planet {
            position: fixed; bottom: 12px; left: 15px; z-index: 2;
            animation: bounce 2s ease-in-out infinite alternate;
        }
        .happy-planet {
            width: 60px; height: 60px; border-radius: 50%;
            background: linear-gradient(45deg, #ff9a9e, #fecfef);
            display: flex; align-items: center; justify-content: center;
            font-size: 30px; box-shadow: 0 4px 20px rgba(255, 154, 158, 0.5);
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            100% { transform: translateY(-10px); }
        }
        @keyframes bounce {
            0% { transform: translateY(0px); }
            100% { transform: translateY(-5px); }
        }
        
        .level-selector {
            display: flex; justify-content: center; gap: 15px; margin: 30px 0;
            flex-wrap: wrap;
        }
        .level-btn {
            padding: 20px 35px; border: none; border-radius: 15px; cursor: pointer;
            font-size: 1.3em; font-weight: bold; transition: all 0.3s;
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white; box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            min-width: 180px;
        }
        .level-btn:hover { transform: translateY(-3px); box-shadow: 0 8px 25px rgba(0,0,0,0.4); }
        .level-btn.intermediate { background: linear-gradient(45deg, #f39c12, #e67e22); }
        .level-btn.advanced { background: linear-gradient(45deg, #9b59b6, #8e44ad); }
        .level-btn.professional { background: linear-gradient(45deg, #e74c3c, #c0392b); }
        .quiz-container {
            background: rgba(255,255,255,0.1); padding: 30px; border-radius: 20px;
            backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2);
            display: none;
        }
        .question-card {
            background: rgba(255,255,255,0.05); padding: 25px; border-radius: 15px;
            margin-bottom: 25px; border: 1px solid rgba(255,255,255,0.1);
        }
        .question-text { font-size: 1.3em; margin-bottom: 20px; line-height: 1.6; }
        .answers { display: grid; gap: 15px; }
        .answer-btn {
            padding: 15px 20px; border: none; border-radius: 12px; cursor: pointer;
            font-size: 1.1em; background: rgba(255,255,255,0.1); color: white;
            transition: all 0.3s; text-align: left;
            border: 2px solid transparent;
        }
        .answer-btn:hover {
            background: rgba(255,255,255,0.2); transform: translateX(10px);
            border-color: rgba(255,255,255,0.3);
        }
        .answer-btn.correct {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            border-color: #27ae60;
        }
        .answer-btn.wrong {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            border-color: #e74c3c;
        }
        .progress-container {
            background: rgba(255,255,255,0.1); border-radius: 10px; margin: 20px 0;
            overflow: hidden; height: 12px;
        }
        .progress-bar {
            height: 100%; background: linear-gradient(45deg, #3498db, #2980b9);
            transition: width 0.5s ease; border-radius: 10px;
        }
        .score-display {
            text-align: center; font-size: 1.2em; margin: 20px 0;
            padding: 15px; background: rgba(255,255,255,0.1); border-radius: 10px;
        }
        .results-container {
            text-align: center; display: none; padding: 30px;
            background: rgba(255,255,255,0.1); border-radius: 20px;
            backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2);
        }
        .confetti {
            position: fixed; width: 10px; height: 10px; z-index: 100;
            animation: confetti-fall 3s linear forwards;
        }
        @keyframes confetti-fall {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }
        .control-buttons {
            display: flex; justify-content: center; gap: 15px; margin: 20px 0;
            flex-wrap: wrap;
        }
        .control-btn {
            padding: 12px 20px; border: none; border-radius: 10px; cursor: pointer;
            background: linear-gradient(45deg, #3498db, #2980b9); color: white;
            font-size: 1em; transition: all 0.3s;
        }
        .control-btn:hover { transform: translateY(-2px); }
        .motivational-quote {
            font-style: italic; font-size: 1.1em; color: #f39c12;
            margin: 20px 0; padding: 15px; background: rgba(243, 156, 18, 0.1);
            border-radius: 10px; border-left: 4px solid #f39c12;
        }
        @media (max-width: 600px) {
            .quiz-title { font-size: 2em; }
            .level-selector { flex-direction: column; align-items: center; }
            .control-buttons { flex-direction: column; align-items: center; }
            .astronaut { width: 40px; height: 40px; font-size: 20px; }
            .planet-saturn { width: 40px; height: 40px; }
            .planet-neptune { width: 35px; height: 35px; }
            .happy-planet { width: 50px; height: 50px; font-size: 24px; }
            .level-btn {
                padding: 18px 30px;
                font-size: 1.2em;
                min-width: 160px;
            }
        }
    </style>
</head>
<body>
    <div class="stars" id="stars"></div>
    
    <!-- Add clap sound audio element -->
    <audio id="clapSound" src="https://www.soundjay.com/misc/sounds/bell-ringing-05.wav" preload="auto"></audio>
    
    <div class="container">
        <!-- CSS Planets Header -->
        <div class="planets-header">
            <div class="planet-saturn"></div>
            <div class="planet-neptune"></div>
        </div>
        
        <div class="quiz-header">
            <h1 class="quiz-title">üöÄ Space Habitat Quiz Game</h1>
            
            <!-- CSS Astronaut Avatars -->
            <div class="astronaut-avatars">
                <div class="astronaut astronaut-1">üë®‚ÄçüöÄ</div>
                <div class="astronaut astronaut-2">üë©‚ÄçüöÄ</div>
                <div class="astronaut astronaut-3">üßë‚ÄçüöÄ</div>
            </div>
            
            <p>Test your knowledge about NASA space habitats and engineering!</p>
        </div>

        <div class="level-selector" id="levelSelector">
            <button class="level-btn" onclick="startQuiz('beginner')">
                <i class="fas fa-star"></i> Beginner
            </button>
            <button class="level-btn intermediate" onclick="startQuiz('intermediate')">
                <i class="fas fa-rocket"></i> Intermediate  
            </button>
            <button class="level-btn advanced" onclick="startQuiz('advanced')">
                <i class="fas fa-satellite"></i> Advanced
            </button>
            <button class="level-btn professional" onclick="startQuiz('professional')">
                <i class="fas fa-space-shuttle"></i> Professional
            </button>
        </div>

        <div class="quiz-container" id="quizContainer">
            <div class="score-display" id="scoreDisplay">
                Question <span id="currentQ">1</span> of <span id="totalQ">7</span> | Score: <span id="currentScore">0</span>
            </div>
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <div class="question-card" id="questionCard"></div>
            <div class="control-buttons">
                <button class="control-btn" onclick="nextQuestion()">
                    <i class="fas fa-arrow-right"></i> Next Question
                </button>
                <button class="control-btn" onclick="restartQuiz()" style="background: linear-gradient(45deg, #e74c3c, #c0392b);">
                    <i class="fas fa-redo"></i> Restart
                </button>
            </div>
        </div>

        <div class="results-container" id="resultsContainer">
            <h2 id="resultsTitle">üéâ Quiz Complete!</h2>
            <div class="score-display">
                Your Score: <span id="finalScore">0</span> out of <span id="totalQuestions">7</span>
            </div>
            <div id="scoreMessage"></div>
            <div class="motivational-quote" id="motivationalQuote"></div>
            <div class="control-buttons">
                <button class="control-btn" onclick="restartQuiz()">
                    <i class="fas fa-play"></i> Play Again
                </button>
                <button class="control-btn" onclick="backToLevels()" style="background: linear-gradient(45deg, #9b59b6, #8e44ad);">
                    <i class="fas fa-list"></i> Choose Level
                </button>
            </div>
        </div>
    </div>
    
    <!-- CSS Smiling Planet -->
    <div class="smiling-planet">
        <div class="happy-planet">üòä</div>
    </div>

    <script>
        // Question Bank - All levels with multiple questions each
        const questionBank = {
            beginner: [
                {q: "What is a space habitat?", a: ["A house in space for astronauts", "A swimming pool", "A car"], correct: 0},
                {q: "Why do astronauts need a space habitat?", a: ["To play football", "To live, eat, and sleep safely in space", "To ride bicycles"], correct: 1},
                {q: "What do astronauts do in a habitat?", a: ["Sleep, eat, and exercise", "Swim in the ocean", "Drive buses"], correct: 0},
                {q: "Where can space habitats be?", a: ["On the Moon, in space, or on Mars", "Under the sea only", "On Earth only"], correct: 0},
                {q: "Which of these do astronauts need in a habitat?", a: ["Food and water", "Toys only", "Nothing"], correct: 0},
                {q: "Which is part of a space habitat?", a: ["Kitchen, bed, bathroom, exercise area", "Playground, cinema, zoo", "Hotel, mall, caf√©"], correct: 0},
                {q: "What do astronauts need to sleep well in space?", a: ["Beds or sleep stations", "Clouds and pillows from Earth", "Sleeping outside on the Moon"], correct: 0},
                {q: "Which planet is NASA preparing habitats for after the Moon?", a: ["Mars", "Jupiter", "Venus"], correct: 0},
                {q: "Why must habitats be strong?", a: ["To keep air inside and protect astronauts", "To look beautiful", "To bounce like a ball"], correct: 0},
                {q: "What does 'inflatable' mean for a space home?", a: ["It can be folded small and then blown up big in space", "It is made of wood", "It grows by itself"], correct: 0},
                {q: "What keeps astronauts safe inside inflatable habitats?", a: ["Strong fabric layers and air pressure", "Toys and games", "Candy walls"], correct: 0},
                {q: "Where could inflatable habitats be used?", a: ["On the Moon, Mars, or in space", "Only in schools", "Only on mountains"], correct: 0}
            ],
            intermediate: [
                {q: "What does 'habitable volume' mean?", a: ["Space where astronauts can live and work", "Space for storing rocks only", "Empty space outside the spaceship"], correct: 0},
                {q: "Why does NASA want to test habitats on the Moon first?", a: ["To practice before going to Mars", "To find cheese", "To take pictures only"], correct: 0},
                {q: "What do habitats need for astronauts to stay healthy?", a: ["Life support, food, sleep, and exercise areas", "Only windows", "Music and games only"], correct: 0},
                {q: "Which is an example of a habitat type?", a: ["Inflatable habitat", "Wooden house", "Igloo"], correct: 0},
                {q: "Why is exercise important inside a space habitat?", a: ["To keep astronauts' bodies strong in space", "To make noise", "To pass time"], correct: 0},
                {q: "Why is the Moon a good place to test space habitats?", a: ["It is close to Earth and helps prepare for Mars", "It has beaches", "It has cities already"], correct: 0},
                {q: "Which areas should be separated because of noise?", a: ["Sleeping and exercise areas", "Cooking and eating areas", "Storage areas"], correct: 0},
                {q: "What are three types of habitat designs NASA studies?", a: ["Metallic, inflatable, built from local resources", "Wooden, glass, plastic", "Underwater, underground, mountain"], correct: 0}
            ],
            advanced: [
                {q: "What are the three main classes of habitats defined by NASA?", a: ["Metallic, inflatable, and surface-manufactured", "Plastic, wood, and glass", "Permanent, temporary, floating"], correct: 0},
                {q: "What is 'Net Habitable Volume (NHV)'?", a: ["The volume where astronauts can live/work (excluding storage)", "The total spacecraft size", "The fuel tank size"], correct: 0},
                {q: "Why are 'constraints' important in habitat design?", a: ["They set limits from rockets, mission length, and crew size", "They make design easier", "They are not important"], correct: 0},
                {q: "Which function is included in NHV calculation?", a: ["Exercise", "External propulsion system", "Radiation shielding"], correct: 0},
                {q: "Why weren't old methods sufficient?", a: ["Used short missions and didn't cover all crew functions", "Were too detailed", "Had too much math"], correct: 0},
                {q: "What is one of the biggest challenges for Moon/Mars habitats?", a: ["Payload size and mass limits of rockets", "Distance from New York", "Earth's weather"], correct: 0}
            ],
            professional: [
                {q: "The pressurized volume is divided into which four categories?", a: ["NHV, systems, stowage, and logistics", "NHV, systems, storage, and void volume", "Payload, stowage, crew, and EVA"], correct: 1},
                {q: "In the bottom-up approach, how are volumes defined?", a: ["By assigning volume per crew function, then aggregating", "By taking historical averages", "By scaling from Mars gravity"], correct: 0},
                {q: "What dominates the hygiene volume allocation?", a: ["Full-body cleaning", "Oral hygiene", "Hair styling"], correct: 0},
                {q: "For a 4-crew mission, volume allocated for meal consumption?", a: ["5 m¬≥", "10.09 m¬≥", "15 m¬≥"], correct: 1},
                {q: "Which is excluded from NHV definition?", a: ["Mission-specific utilization equipment", "Sleep areas", "Dining areas"], correct: 0},
                {q: "What happens to NHV when mission duration increases beyond 180 days?", a: ["It plateaus (fixed minimum required)", "It decreases linearly", "It increases indefinitely"], correct: 0}
            ]
        };

        // Motivational Quotes
        const motivationalQuotes = [
            "üåü 'The future belongs to those who believe in the beauty of their dreams.' - Eleanor Roosevelt",
            "üöÄ 'We choose to go to space not because it's easy, but because it's hard.' - JFK",
            "‚≠ê 'The important thing is not to stop questioning.' - Albert Einstein",
            "üåå 'Exploration is really the essence of the human spirit.' - Frank Borman",
            "üí´ 'Space exploration is a force of nature unto itself.' - Neil deGrasse Tyson",
            "üå† 'Dream big and dare to fail.' - Norman Vaughan",
            "üî≠ 'The sky is not the limit, it's just the beginning.' - Anonymous",
            "üõ∏ 'Every expert was once a beginner.' - Robin Sharma"
        ];

        // Game State
        let currentLevel = '';
        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let totalQuestions = 7;
        let selectedAnswer = -1;

        // Initialize Stars Background
        function createStars() {
            const starsContainer = document.getElementById('stars');
            for (let i = 0; i < 150; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.width = star.style.height = Math.random() * 3 + 1 + 'px';
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }

        // NEW: Clap Sound + "Bravoooo!" Function
        function playClapAndBravo() {
            // Try to play clap sound
            const clap = document.getElementById('clapSound');
            if (clap) {
                clap.currentTime = 0;
                clap.play().catch(e => console.log('Audio play failed:', e));
            }

            // Say "Bravoooo!" after a short delay
            setTimeout(() => {
                if ('speechSynthesis' in window) {
                    const utterance = new SpeechSynthesisUtterance("Bravoooo!");
                    utterance.rate = 1;
                    utterance.pitch = 1.2;
                    utterance.volume = 0.8;
                    window.speechSynthesis.speak(utterance);
                }
            }, 800); // Start speech after clap begins
        }

        // Audio Functions
        function playSuccessSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime);
                oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1);
                oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2);
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            } catch (e) {
                console.log('Audio context not available');
            }
        }

        function playFailSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(220, audioContext.currentTime);
                oscillator.frequency.setValueAtTime(185, audioContext.currentTime + 0.2);
                oscillator.frequency.setValueAtTime(164.81, audioContext.currentTime + 0.4);
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.8);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.8);
            } catch (e) {
                console.log('Audio context not available');
            }
        }

        function playCelebrationSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                for (let i = 0; i < 3; i++) {
                    setTimeout(() => {
                        const oscillator = audioContext.createOscillator();
                        const gainNode = audioContext.createGain();
                        
                        oscillator.connect(gainNode);
                        gainNode.connect(audioContext.destination);
                        
                        const frequencies = [523.25, 659.25, 783.99];
                        oscillator.frequency.setValueAtTime(frequencies[i], audioContext.currentTime);
                        
                        gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                        
                        oscillator.start(audioContext.currentTime);
                        oscillator.stop(audioContext.currentTime + 0.3);
                    }, i * 100);
                }
            } catch (e) {
                console.log('Audio context not available');
            }
        }

        // Confetti Animation
        function createConfetti() {
            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#ffeaa7', '#dda0dd'];
            
            for (let i = 0; i < 100; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 3 + 's';
                document.body.appendChild(confetti);
                
                setTimeout(() => confetti.remove(), 3000);
            }
        }

        // Quiz Functions
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function startQuiz(level) {
            currentLevel = level;
            currentQuestionIndex = 0;
            score = 0;
            selectedAnswer = -1;
            
            const allQuestions = questionBank[level];
            currentQuestions = shuffleArray(allQuestions).slice(0, totalQuestions);
            
            document.getElementById('levelSelector').style.display = 'none';
            document.getElementById('quizContainer').style.display = 'block';
            document.getElementById('resultsContainer').style.display = 'none';
            
            updateScore();
            showQuestion();
        }

        function showQuestion() {
            const question = currentQuestions[currentQuestionIndex];
            const card = document.getElementById('questionCard');
            
            // Random astronaut emoji for each question
            const astronauts = ['üë®‚ÄçüöÄ', 'üë©‚ÄçüöÄ', 'üßë‚ÄçüöÄ', 'üëΩ', 'üõ∏'];
            const astronautEmoji = astronauts[Math.floor(Math.random() * astronauts.length)];
            
            let html = `
                <div style="display:flex; align-items:center; gap:14px; margin-bottom:1.1em;">
                    <div style="width:40px; height:40px; background:linear-gradient(45deg, #ff6b6b, #4ecdc4); 
                         border-radius:50%; display:flex; align-items:center; justify-content:center; 
                         font-size:20px; box-shadow: 0 2px 10px rgba(0,0,0,0.3);">${astronautEmoji}</div>
                    <div class="question-text"><strong>Q${currentQuestionIndex + 1}:</strong> ${question.q}</div>
                </div>
                <div class="answers">
            `;
            
            question.a.forEach((answer, index) => {
                html += `
                    <button class="answer-btn" onclick="selectAnswer(${index})">
                        ${String.fromCharCode(65 + index)}) ${answer}
                    </button>
                `;
            });
            
            html += '</div>';
            card.innerHTML = html;
            
            updateProgress();
            selectedAnswer = -1;
        }

        function selectAnswer(answerIndex) {
            if (selectedAnswer !== -1) return;
            
            selectedAnswer = answerIndex;
            const buttons = document.querySelectorAll('.answer-btn');
            const question = currentQuestions[currentQuestionIndex];
            
            buttons.forEach((btn, index) => {
                if (index === question.correct) {
                    btn.classList.add('correct');
                } else if (index === answerIndex && index !== question.correct) {
                    btn.classList.add('wrong');
                }
                btn.disabled = true;
            });
            
            if (answerIndex === question.correct) {
                score++;
                playSuccessSound();
            } else {
                playFailSound();
            }
            
            updateScore();
        }

        function nextQuestion() {
            if (selectedAnswer === -1) {
                alert('Please select an answer first!');
                return;
            }
            
            currentQuestionIndex++;
            
            if (currentQuestionIndex >= currentQuestions.length) {
                showResults();
            } else {
                showQuestion();
            }
        }

        function updateScore() {
            document.getElementById('currentQ').textContent = currentQuestionIndex + 1;
            document.getElementById('totalQ').textContent = currentQuestions.length;
            document.getElementById('currentScore').textContent = score;
        }

        function updateProgress() {
            const progress = ((currentQuestionIndex) / currentQuestions.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }

        function showResults() {
            document.getElementById('quizContainer').style.display = 'none';
            document.getElementById('resultsContainer').style.display = 'block';
            
            const percentage = Math.round((score / currentQuestions.length) * 100);
            document.getElementById('finalScore').textContent = score;
            document.getElementById('totalQuestions').textContent = currentQuestions.length;
            
            let message = '';
            let title = '';
            
            // ENHANCED: Check if score is 4 or more for special celebration
            if (score >= 4) {
                title = 'üéâ Bravoooo! Excellent Space Engineer!';
                message = `Outstanding! You scored ${score} out of ${currentQuestions.length} (${percentage}%)! You're ready to design real space habitats!`;
                playClapAndBravo(); // Play clap + "Bravoooo!"
                if (percentage >= 80) {
                    playCelebrationSound();
                    createConfetti();
                }
            } else if (percentage >= 60) {
                title = 'üöÄ Great Job! Mission Specialist!';
                message = `Well done! You scored ${percentage}%! You have solid knowledge of space habitats!`;
                playSuccessSound();
            } else if (percentage >= 40) {
                title = '‚≠ê Good Start! Space Cadet!';
                message = `Not bad! You scored ${percentage}%! Keep learning about space exploration!`;
                playSuccessSound();
            } else {
                title = 'üåü Keep Learning! Future Astronaut!';
                message = `You scored ${percentage}%. Don't give up - every expert was once a beginner!`;
                playFailSound();
            }
            
            document.getElementById('resultsTitle').textContent = title;
            document.getElementById('scoreMessage').innerHTML = `<p>${message}</p>`;
            
            const randomQuote = motivationalQuotes[Math.floor(Math.random() * motivationalQuotes.length)];
            document.getElementById('motivationalQuote').textContent = randomQuote;
        }

        function restartQuiz() {
            if (currentLevel) {
                startQuiz(currentLevel);
            } else {
                backToLevels();
            }
        }

        function backToLevels() {
            document.getElementById('levelSelector').style.display = 'flex';
            document.getElementById('quizContainer').style.display = 'none';
            document.getElementById('resultsContainer').style.display = 'none';
            currentLevel = '';
        }

        // Initialize
        window.addEventListener('load', () => {
            createStars();
        });
    </script>
</body>
</html>